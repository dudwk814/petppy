<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<style>
  .ck-editor__editable {
    min-height: 650px;
  }
</style>
<th:block th:replace="~{/fragments/basicLayout :: setContent(~{this::content})}">
  <th:block th:fragment="content">
    <section class="hero-wrap hero-wrap-2" style="background-image: url('/petppy/images/bg_2.jpg');" data-stellar-background-ratio="0.5">
      <div class="overlay"></div>
      <div class="container">
        <div class="row no-gutters slider-text align-items-end">
          <div class="col-md-9 ftco-animate pb-5">
            <p class="breadcrumbs mb-2"><span class="mr-2"><a th:href="@{/}">Home <i class="ion-ios-arrow-forward"></i></a></span> <span class="mr-2"><a th:href="@{/board/}">Board <i class="ion-ios-arrow-forward"></i></a></span> <span>Board Edit<i class="ion-ios-arrow-forward"></i></span></p>
            <h1 class="mb-0 bread">Edit</h1>
          </div>
        </div>
      </div>
    </section>
    <section class="ftco-section bg-light">
      <div class="container">
        <form action="/board/edit" method="post">
          <input type="hidden" name="email" th:value="${session.user.email}">
          <input type="hidden" name="hit" value="0">
          <input type="hidden" name="commentCount" value="0">
          <input type="hidden" name="id" th:value="${session.user.id}">
          <div class="input-group">
            <input class="form-control" name="title" placeholder="제목" style="margin-bottom: 15px;">
          </div>
          <textarea name="content" id="summernote"></textarea>
        <div class="row d-flex">
          <div class="col-md-12" style="height: 70px; margin-top: 15px;">
            <a th:href="@{/board}" class="btn btn-secondary" aria-hidden="true" data-toggle="tooltip" data-placement="top" title="게시글 목록으로 돌아가기">목록</a>
            <button type="submit" class="btn btn-success float-right" aria-hidden="true" data-toggle="tooltip" data-placement="top" title="게시글 저장하기">저장</button>
          </div>
        </div>
        </form>
      </div>
    </section>

  </th:block>
</th:block>
<script th:inline="javascript">
  $(document).ready(function () {
    /* summernote 로딩 */
    $('#summernote').summernote({
      height: 500,                 // 에디터 높이
      minHeight: null,             // 최소 높이
      maxHeight: null,             // 최대 높이
      focus: true,                  // 에디터 로딩후 포커스를 맞출지 여부
      lang: "ko-KR",					// 한글 설정
      placeholder: '최대 2048자까지 쓸 수 있습니다',	//placeholder 설정
      toolbar: [
        // [groupName, [list of button]]
        ['fontname', ['fontname']],
        ['fontsize', ['fontsize']],
        ['style', ['bold', 'italic', 'underline','strikethrough', 'clear']],
        ['color', ['forecolor','color']],
        ['table', ['table']],
        ['para', ['ul', 'ol', 'paragraph']],
        ['height', ['height']],
        ['insert',['picture','link','video']],
        ['view', ['fullscreen', 'help']],
        ['']
      ],
      fontNames: ['Arial', 'Arial Black', 'Comic Sans MS', 'Courier New','맑은 고딕','궁서','굴림체','굴림','돋움체','바탕체'],
      fontSizes: ['8','9','10','11','12','14','16','18','20','22','24','28','30','36','50','72']
      callbacks: {	//여기 부분이 이미지를 첨부하는 부분
        onImageUpload : function(files) {
          uploadSummernoteImageFile(files[0],this);
        },
        onPaste: function (e) {
          var clipboardData = e.originalEvent.clipboardData;
          if (clipboardData && clipboardData.items && clipboardData.items.length) {
            var item = clipboardData.items[0];
            if (item.kind === 'file' && item.type.indexOf('image/') !== -1) {
              e.preventDefault();
            }
          }
        }
      }

    });

    /**
     * 이미지 파일 업로드
     */
    function uploadSummernoteImageFile(file, editor) {
      data = new FormData();
      data.append("file", file);
      $.ajax({
        data : data,
        type : "POST",
        url : "/board/uploadSummernoteImageFile",
        contentType : false,
        processData : false,
        success : function(data) {
          //항상 업로드된 파일의 url이 있어야 한다.
          $(editor).summernote('insertImage', data.url);
        }
      });
    }

  });
</script>
</html>